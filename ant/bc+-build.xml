<?xml version="1.0" encoding="UTF-8"?>

<project name="crypto.bcbuild" default="build" basedir=".">

    <property file="bc-build.properties" />
    <property environment="env" />

    <property name="target.name" value="${target.prefix}-${release.suffix}" />
    <property name="build.dir" value="${src.dir}/.." />
    <property name="bzip2.src.dir" value="${basedir}/pg/src/main/java" />
    <property name="artifacts.reports.xml.dir" value="${artifacts.dir}/reports/xml" />
    <property name="artifacts.reports.html.dir" value="${artifacts.dir}/reports/html" />
    <property name="artifacts.jars.dir" value="${artifacts.dir}/jars" />
    <property name="artifacts.docs.dir" value="${artifacts.dir}/javadoc" />

    <property name="jce.target" value="jce-${target.name}" />
    <property name="jce.target.dir" value="${artifacts.dir}/${jce.target}" />
    <property name="jce.target.src.dir" value="${jce.target.dir}/src" />
    <property name="jce.target.docs.dir" value="${jce.target.dir}/javadoc" />
    <property name="jce.target.src.zip" value="${jce.target.dir}/src.zip" />

    <property name="provider.target" value="bcprov-${target.name}" />
    <property name="provider.target.dir" value="${artifacts.dir}/${provider.target}" />
    <property name="provider.target.src.dir" value="${provider.target.dir}/src" />
    <property name="provider.target.docs.dir" value="${provider.target.dir}/javadoc" />
    <property name="provider.target.src.zip" value="${provider.target.dir}/src.zip" />

    <property name="mail.target" value="bcmail-${target.name}" />
    <property name="mail.target.dir" value="${artifacts.dir}/${mail.target}" />
    <property name="mail.target.src.dir" value="${mail.target.dir}/src" />
    <property name="mail.target.docs.dir" value="${mail.target.dir}/javadoc" />
    <property name="mail.target.src.zip" value="${mail.target.dir}/src.zip" />

    <property name="jmail.target" value="bcjmail-${target.name}" />
    <property name="jmail.target.dir" value="${artifacts.dir}/${jmail.target}" />
    <property name="jmail.target.src.dir" value="${jmail.target.dir}/src" />
    <property name="jmail.target.docs.dir" value="${jmail.target.dir}/javadoc" />
    <property name="jmail.target.src.zip" value="${jmail.target.dir}/src.zip" />

    <property name="pkix.target" value="bcpkix-${target.name}" />
    <property name="pkix.target.dir" value="${artifacts.dir}/${pkix.target}" />
    <property name="pkix.target.src.dir" value="${pkix.target.dir}/src" />
    <property name="pkix.target.docs.dir" value="${pkix.target.dir}/javadoc" />
    <property name="pkix.target.src.zip" value="${pkix.target.dir}/src.zip" />

    <property name="pg.target" value="bcpg-${target.name}" />
    <property name="pg.target.dir" value="${artifacts.dir}/${pg.target}" />
    <property name="pg.target.src.dir" value="${pg.target.dir}/src" />
    <property name="pg.target.docs.dir" value="${pg.target.dir}/javadoc" />
    <property name="pg.target.src.zip" value="${pg.target.dir}/src.zip" />

    <property name="tls.target" value="bctls-${target.name}" />
    <property name="tls.target.dir" value="${artifacts.dir}/${tls.target}" />
    <property name="tls.target.src.dir" value="${tls.target.dir}/src" />
    <property name="tls.target.docs.dir" value="${tls.target.dir}/javadoc" />
    <property name="tls.target.src.zip" value="${tls.target.dir}/src.zip" />

    <property name="util.target" value="bcutil-${target.name}" />
    <property name="util.target.dir" value="${artifacts.dir}/${util.target}" />
    <property name="util.target.src.dir" value="${util.target.dir}/src" />
    <property name="util.target.docs.dir" value="${util.target.dir}/javadoc" />
    <property name="util.target.src.zip" value="${util.target.dir}/src.zip" />

    <property name="lcrypto.target" value="lcrypto-${target.name}" />
    <property name="lcrypto.target.dir" value="${artifacts.dir}/${lcrypto.target}" />
    <property name="lcrypto.target.src.dir" value="${lcrypto.target.dir}/src" />
    <property name="lcrypto.target.classes.dir" value="${lcrypto.target.dir}/classes" />
    <property name="lcrypto.target.docs.dir" value="${lcrypto.target.dir}/javadoc" />

    <path id="project.classpath">
        <pathelement location="${mail.jar.home}" />
        <pathelement location="${activation.jar.home}" />
        <pathelement location="${jmail.jar.home}" />
        <pathelement location="${jactivation.jar.home}" />
        <pathelement location="${junit.jar.home}" />
    </path> 

    <target name="pack200-on" if="pack200.enabled">
        <taskdef name="pack200" classname="com.sun.tools.apache.ant.pack200.Pack200Task"
            classpath="lib/Pack200Task.jar"/>
        <macrodef name="packJar">
            <attribute name="jarbase" />
            <element name="manifest-element" />
            <element name="fileset-element" />
            <sequential>
                <jar jarfile="@{jarbase}.tmp.jar">
                    <manifest-element/>
                    <fileset-element/>
                </jar>
                <pack200 src="@{jarbase}.tmp.jar" destfile="@{jarbase}.jar" repack="true" segmentLimit="-1" />
                <delete file="@{jarbase}.tmp.jar" />
            </sequential>
        </macrodef>
    </target>
    <target name="pack200-off" unless="pack200.enabled">
        <macrodef name="packJar">
            <attribute name="jarbase" />
            <element name="manifest-element" />
            <element name="fileset-element" />
            <sequential>
                <jar jarfile="@{jarbase}.jar">
                    <manifest-element/>
                    <fileset-element/>
                </jar>
            </sequential>
        </macrodef>
    </target>
    <target name="initPackJar" depends="pack200-on, pack200-off" />

    <target name="initMacros" depends="initPackJar">

        <macrodef name="compile">
            <attribute name="target" />
            <element name="manifestElements" />
            <element name="jarFileSet" />
            <sequential>
                <mkdir dir="${build.dir}/@{target}/classes" />
                <mkdir dir="${artifacts.dir}/@{target}" />

                <javac source="${bc.javac.source}" target="${bc.javac.target}"
                    srcdir="${artifacts.dir}/@{target}/src"
                    destdir="${build.dir}/@{target}/classes"
                    memoryMaximumSize="512m"
                    debug="${release.debug}" fork="true">
                    <classpath>
                        <path refid="project.classpath" /> 
                        <fileset dir="${artifacts.jars.dir}">
                            <include name="**/*.jar" />
                        </fileset>
                    </classpath>
                </javac>
                <copy todir="${build.dir}/@{target}/classes">
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.properties" />
                </copy>
                <packJar jarbase="${artifacts.jars.dir}/@{target}">
                    <manifest-element>
                        <manifest>
                            <manifestElements/>
                        </manifest>
                    </manifest-element>
                    <fileset-element>
                        <fileset dir="${build.dir}/@{target}/classes">
                            <jarFileSet/>
                        </fileset>
                    </fileset-element>
                </packJar>
            </sequential>
        </macrodef>

        <macrodef name="compile-test">
            <attribute name="target" />
            <element name="manifestElements" />
            <sequential>
                <mkdir dir="${build.dir}/@{target}/classes" />
                <mkdir dir="${artifacts.dir}/@{target}" />

                <javac source="${bc.javac.source}" target="${bc.javac.target}"
                    srcdir="${artifacts.dir}/@{target}/src"
                    destdir="${build.dir}/@{target}/classes"
                    memoryMaximumSize="512m"
                    debug="${release.debug}">
                    <classpath>
                        <path refid="project.classpath" /> 
                        <fileset dir="${artifacts.jars.dir}">
                            <include name="**/*.jar" />
                        </fileset>
                    </classpath>
                </javac>
                <copy todir="${build.dir}/@{target}/classes">
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.asc" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.pem" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.p7m" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.message" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.properties" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.eml" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.sig" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.data" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.crt" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.cvcert" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.kbx" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.csr" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.crl" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.cer" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.oer" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.kbx" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.key" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.der" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.txt" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.rsp" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.gpg" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.pub" />
                     <fileset dir="${artifacts.dir}/@{target}/src" includes="**/*.sec" />
                </copy>
                <packJar jarbase="${artifacts.jars.dir}/@{target}">
                    <manifest-element>
                        <manifest>
                            <manifestElements/>
                        </manifest>
                    </manifest-element>
                    <fileset-element>
                        <fileset dir="${build.dir}/@{target}/classes">
                            <include name="**/*.class" />
                            <include name="**/*.asc" />
                            <include name="**/*.pem" />
                            <include name="**/*.p7m" />
                            <include name="**/*.crl" />
                            <include name="**/*.der" />
                            <include name="**/*.crt" />
                            <include name="**/*.csr" />
                            <include name="**/*.cvcert" />
                            <include name="**/*.eml" />
                            <include name="**/*.sig" />
                            <include name="**/*.data" />
                            <include name="**/*.cer" />
                            <include name="**/*.oer" />
                            <include name="**/*.kbx" />
                            <include name="**/*.der" />
                            <include name="**/*.message" />
                            <include name="**/*.txt" />
                            <include name="**/*.rsp" />
                            <include name="**/*.key" />
                            <include name="**/*.gpg" />
                            <include name="**/*.pub" />
                            <include name="**/*.sec" />
                            <include name="**/*.properties" />
                        </fileset>
                    </fileset-element>
                </packJar>
            </sequential>
        </macrodef>

        <macrodef name="compile-doc">
            <attribute name="srcDir" />
            <attribute name="docsDir" />
            <element name="docElements" />
            <sequential>
            <mkdir dir="@{docsDir}" />
            <javadoc maxmemory="384m" sourcepath="@{srcDir}"
                     destdir="@{docsDir}"
                     windowtitle="Bouncy Castle Library ${release.name} API Specification"
                     header="&lt;b&gt;Bouncy Castle Cryptography Library ${release.name}&lt;/b&gt;">
                <docElements/>
                <arg value="${javadoc.args}" />
                <classpath>
                    <path refid="project.classpath" /> 
                    <fileset dir="${artifacts.jars.dir}">
                        <include name="**/*.jar" />
                    </fileset>
                    <pathelement path="${env.CLASSPATH}" />
                </classpath>
            </javadoc>
            </sequential>
        </macrodef>

        <macrodef name="copyStandardFiles">
            <attribute name="toDir" />
            <sequential>
                <copy toDir="@{toDir}">
                     <fileset dir="${basedir}">
                         <include name="*.html" />
                     </fileset>
                </copy>
                <copy toDir="@{toDir}/docs">
                     <fileset dir="${basedir}/docs">
                         <include name="**/*.html" />
                     </fileset>
                </copy>
            </sequential>
        </macrodef>

    </target>

    <target name="build" depends="initMacros, build-lw, build-libraries, build-test" />

    <target name="build-lw" depends="initMacros">
        <!--
              Lightweight Libraries
        -->

        <mkdir dir="${lcrypto.target.dir}" />
        <mkdir dir="${lcrypto.target.src.dir}" />
        <mkdir dir="${lcrypto.target.classes.dir}" />

        <copyStandardFiles toDir="${lcrypto.target.dir}" />

        <copy todir="${lcrypto.target.src.dir}">
             <fileset dir="${src.dir}">
                 <exclude name="build/**" />
                 <include name="org.spongycastle.*.java" />
                 <include name="org.spongycastle.math/**/*.java" />
                 <include name="org.spongycastle.crypto/**/*.java" />
                 <include name="org.spongycastle.util/**/*.java" />
                 <include name="org.spongycastle.asn1/**/*.java" />
                 <include name="org.spongycastle.internal/**/*.java" />
                 <include name="org.spongycastle.pqc/crypto/**/*.java" />
                 <include name="org.spongycastle.pqc/math/**/*.java" />
                 <include name="org.spongycastle.pqc/asn1/**/*.java" />
                 <exclude name="org.spongycastle.pqc/**/*Tests.java" />
                 <exclude name="org.spongycastle.pqc/**/LMSVectorUtils.java" />
             </fileset>
        </copy>

        <javac source="${bc.javac.source}" target="${bc.javac.target}"
            srcdir="${lcrypto.target.src.dir}"
            destdir="${lcrypto.target.classes.dir}"
	    memoryMaximumSize="512m"
            fork="true"
            debug="${release.debug}">
            <classpath>
                <path refid="project.classpath" /> 
            </classpath>
        </javac>
    </target>

    <!--
          Provider
    -->
    <target name="build-provider" depends="initMacros">
        <property name="provider" value="bcprov-${target.name}" />
        <property name="extprovider" value="bcprov-ext-${target.name}" />

        <mkdir dir="${artifacts.jars.dir}" />
        <delete dir="${provider.target.dir}" />
        <mkdir dir="${provider.target.dir}" />

        <copyStandardFiles toDir="${provider.target.dir}" />

        <copy todir="${provider.target.src.dir}">
             <fileset dir="${src.dir}">
                 <exclude name="build/**" />
                 <exclude name="PKITS/**" />
                 <exclude name="cmp/**" />
                 <exclude name="rfc4134/**" />
                 <exclude name="pgpdata/**" />
                 <exclude name="org.spongycastle.**/AllTests.java" />
                 <exclude name="org.spongycastle.**/test/**" />
                 <exclude name="org.spongycastle.crypto/*/*Test.java" />
                 <exclude name="org.spongycastle.asn1/*/*Test.java" />
                 <exclude name="org.spongycastle.util/*Test.java" />
                 <exclude name="org.spongycastle.pqc/**/*Tests.java" />
                 <exclude name="org.spongycastle.pqc/**/LMSVectorUtils.java" />
                 <exclude name="**/*.crl" />
                 <exclude name="org.spongycastle.util/utiltest/**" />
                 <exclude name="org.spongycastle.asn1/bsi/**" />
                 <exclude name="org.spongycastle.asn1/cmc/**" />
                 <exclude name="org.spongycastle.asn1/cmp/**" />
                 <exclude name="org.spongycastle.asn1/cms/**" />
                 <exclude name="org.spongycastle.asn1/crmf/**" />
                 <exclude name="org.spongycastle.asn1/dvcs/**" />
                 <exclude name="org.spongycastle.asn1/eac/**" />
                 <exclude name="org.spongycastle.asn1/esf/**" />
                 <exclude name="org.spongycastle.asn1/ess/**" />
                 <exclude name="org.spongycastle.asn1/est/**" />
                 <exclude name="org.spongycastle.asn1/icao/**" />
                 <exclude name="org.spongycastle.asn1/isismtt/**" />
                 <exclude name="org.spongycastle.asn1/its/**" />
                 <exclude name="org.spongycastle.asn1/smime/**" />
                 <exclude name="org.spongycastle.asn1/tsp/**" />
                 <exclude name="org.spongycastle.bcpg/**" />
                 <exclude name="org.spongycastle.cert/**" />
                 <exclude name="org.spongycastle.cms/**" />
                 <exclude name="org.spongycastle.pkix/**" />
                 <exclude name="org.spongycastle.dvcs/**" />
                 <exclude name="org.spongycastle.eac/**" />
                 <exclude name="org.spongycastle.est/**" />
                 <exclude name="org.spongycastle.cmc/**" />
                 <exclude name="org.spongycastle.mime/**" />
                 <exclude name="org.spongycastle.mail/**" />
                 <exclude name="org.spongycastle.gpg/**" />
                 <exclude name="org.spongycastle.its/**" />
                 <exclude name="org.spongycastle.oer/**" />
                 <exclude name="org.spongycastle.openpgp/**" />
                 <exclude name="org.spongycastle.openssl/**" />
                 <exclude name="org.spongycastle.mozilla/**" />
                 <exclude name="org.spongycastle.operator/**" />
                 <exclude name="org.spongycastle.pkcs/**" />
                 <exclude name="org.spongycastle.tsp/**" />
                 <exclude name="org.spongycastle.voms/**" />
                 <exclude name="org.spongycastle.apache/**" />
                 <exclude name="org.spongycastle.tls/**" />
                 <exclude name="org.spongycastle.jsse/**" />
             </fileset>
             <fileset dir="${src.dir}">
                 <include name="org.spongycastle.x509/CertPathReviewerMessages*.properties" />
             </fileset>
             <fileset dir="${src.dir}" includes="org.spongycastle.util/test/*.java" />
        </copy>

        <compile target="${provider}">
            <jarFileSet>
                <include name="**/*.class"/>
                <exclude name="**/javax/crypto/**/*.class"/>
                <exclude name="**/NTRU*.class" />
                <exclude name="**/ntru/**/*.class" />
                <include name="**/*.properties"/>
            </jarFileSet>
            <manifestElements>
                <attribute name="Manifest-Version" value="1.0" />
                <attribute name="Extension-Name" value="org.spongycastle.bcprovider" />
                <attribute name="Specification-Vendor" value="BouncyCastle.org" />
                <attribute name="Specification-Version" value="1.1" />
                <attribute name="Implementation-Vendor-Id" value="org.spongycastle. />
                <attribute name="Implementation-Vendor" value="BouncyCastle.org" />
                <attribute name="Implementation-Version" value="${release.name}.0" />
                <attribute name="Application-Name" value="Bouncy Castle Provider" />
                <attribute name="Trusted-Library" value="true" />
                <attribute name="Permissions" value="all-permissions" />
                <attribute name="Codebase" value="*" />
                <attribute name="Application-Library-Allowable-Codebase" value="*" />
                <attribute name="Caller-Allowable-Codebase" value="*" />
                <attribute name="Automatic-Module-Name" value="org.spongycastle.provider" />
            </manifestElements>
        </compile>

        <packJar jarbase="${artifacts.jars.dir}/${extprovider}">
            <manifest-element>
                <manifest>
                    <attribute name="Manifest-Version" value="1.0" />
                    <attribute name="Extension-Name" value="org.spongycastle.bcproviderext" />
                    <attribute name="Specification-Vendor" value="BouncyCastle.org" />
                    <attribute name="Specification-Version" value="1.1" />
                    <attribute name="Implementation-Vendor-Id" value="org.spongycastle. />
                    <attribute name="Implementation-Vendor" value="BouncyCastle.org" />
                    <attribute name="Implementation-Version" value="${release.version}.0" />
                    <attribute name="Application-Name" value="Bouncy Castle Provider" />
                    <attribute name="Trusted-Library" value="true" />
                    <attribute name="Permissions" value="all-permissions" />
                    <attribute name="Codebase" value="*" />
                    <attribute name="Application-Library-Allowable-Codebase" value="*" />
                    <attribute name="Caller-Allowable-Codebase" value="*" />
                </manifest>
            </manifest-element>
            <fileset-element>
                <fileset dir="${build.dir}/${provider}/classes">
                    <include name="**/*.class"/>
                    <exclude name="**/javax/crypto/**/*.class"/>
                    <include name="**/*.properties"/>
                </fileset>
            </fileset-element>
        </packJar>

    </target>

    <!--
          JCE
    -->
    <target name="build-jce" depends="initMacros">
        <property name="jce" value="jce-${target.name}" />
        <property name="extjce" value="jce-ext-${target.name}" />

        <mkdir dir="${artifacts.jars.dir}" />
        <delete dir="${jce.target.dir}" />
        <mkdir dir="${jce.target.dir}" />

        <copyStandardFiles toDir="${jce.target.dir}" />

        <copy todir="${jce.target.src.dir}">
             <fileset dir="${src.dir}">
                 <exclude name="PKITS/**" />
                 <exclude name="cmp/**" />
                 <exclude name="rfc4134/**" />
                 <exclude name="org.spongycastle.**/AllTests.java" />
                 <exclude name="org.spongycastle.**/test/**" />
                 <exclude name="org.spongycastle.crypto/*/*Test.java" />
                 <exclude name="org.spongycastle.util/*Test.java" />
                 <exclude name="org.spongycastle.pqc/**/*Tests.java" />
                 <exclude name="org.spongycastle.pqc/**/LMSVectorUtils.java" />
                 <exclude name="**/*.crl" />
                 <exclude name="**/*.key" />
                 <exclude name="org.spongycastle.**.crt" />
                 <exclude name="org.spongycastle.**/test/*.cer" />
                 <exclude name="org.spongycastle.**/test/*.kbx" />
                 <exclude name="org.spongycastle.**/test/*.csr" />
                 <exclude name="org.spongycastle.**/test/*.cvcert" />
                 <exclude name="org.spongycastle.**/test/*.eml" />
                 <exclude name="org.spongycastle.**/test/*.sig" />
                 <exclude name="org.spongycastle.**/test/*.data" />
                 <exclude name="org.spongycastle.**/test/*.der" />
                 <exclude name="org.spongycastle.**/test/*.properties" />
                 <exclude name="org.spongycastle.util/utiltest/**" />
                 <exclude name="org.spongycastle.mime/**" />
                 <exclude name="org.spongycastle.mail/**" />
                 <exclude name="org.spongycastle.cms/**" />
                 <exclude name="org.spongycastle.pkix/**" />
                 <exclude name="org.spongycastle.dvcs/**" />
                 <exclude name="org.spongycastle.eac/**" />
                 <exclude name="org.spongycastle.est/**" />
                 <exclude name="org.spongycastle.cmc/**" />
                 <exclude name="org.spongycastle.cert/**" />
                 <exclude name="org.spongycastle.pkcs/**" />
                 <exclude name="org.spongycastle.operator/**" />
                 <exclude name="org.spongycastle.sasn1/**" />
                 <exclude name="org.spongycastle.tsp/**" />
                 <exclude name="org.spongycastle.gpg/**" />
                 <exclude name="org.spongycastle.openpgp/**" />
                 <exclude name="org.spongycastle.openssl/**" />
                 <exclude name="org.spongycastle.mozilla/**" />
                 <exclude name="org.spongycastle.bcpg/**" />
                 <exclude name="org.spongycastle.voms/**" />
                 <exclude name="org.spongycastle.tls/**" />
                 <exclude name="org.spongycastle.jsse/**" />
                 <exclude name="org/apache/**/*.java" />
             </fileset>
             <fileset dir="${src.dir}" includes="org.spongycastle.util/test/*.java" />
        </copy>

        <compile target="${jce}">
            <jarFileSet>
                <include name="**/*.class"/>
                <exclude name="**/NTRU*.class" />
                <exclude name="**/ntru/**/*.class" />
                <exclude name="org.spongycastle.pqc/**/*Tests.class" />
                <exclude name="org.spongycastle.pqc/**/LMSVectorUtils.class" />
                <include name="**/*.properties"/>
            </jarFileSet>
            <manifestElements>
                <attribute name="Manifest-Version" value="1.0" />
                <attribute name="Extension-Name" value="org.spongycastle.bcjce" />
                <attribute name="Specification-Vendor" value="BouncyCastle.org" />
                <attribute name="Specification-Version" value="1.1" />
                <attribute name="Implementation-Vendor-Id" value="org.spongycastle. />
                <attribute name="Implementation-Vendor" value="BouncyCastle.org" />
                <attribute name="Implementation-Version" value="${release.version}.0" />
                <attribute name="Application-Name" value="Bouncy Castle JCE and Provider" />
                <attribute name="Trusted-Library" value="true" /> 
                <attribute name="Permissions" value="all-permissions" />
                <attribute name="Codebase" value="*" />
                <attribute name="Application-Library-Allowable-Codebase" value="*" />
                <attribute name="Caller-Allowable-Codebase" value="*" />
            </manifestElements>
        </compile>

        <packJar jarbase="${artifacts.jars.dir}/${extjce}">
            <manifest-element>
                <manifest>
                    <attribute name="Manifest-Version" value="1.0" />
                    <attribute name="Extension-Name" value="org.spongycastle.bcjceext" />
                    <attribute name="Specification-Vendor" value="BouncyCastle.org" />
                    <attribute name="Specification-Version" value="1.1" />
                    <attribute name="Implementation-Vendor-Id" value="org.spongycastle. />
                    <attribute name="Implementation-Vendor" value="BouncyCastle.org" />
                    <attribute name="Implementation-Version" value="${release.version}.0" />
                    <attribute name="Application-Name" value="Bouncy Castle JCE and Provider" />
                    <attribute name="Trusted-Library" value="true" />
                    <attribute name="Permissions" value="all-permissions" />
                    <attribute name="Codebase" value="*" />
                    <attribute name="Application-Library-Allowable-Codebase" value="*" />
                    <attribute name="Caller-Allowable-Codebase" value="*" />
                </manifest>
            </manifest-element>
            <fileset-element>
                <fileset dir="${build.dir}/${jce}/classes">
                    <include name="**/*.class"/>
                    <include name="**/*.properties"/>
                </fileset>
            </fileset-element>
        </packJar>
    </target>

    <target name="build-libraries" depends="initMacros, build-pkix, build-pg, build-mail" />

    <!--
          SMIME
    -->
    <target name="build-mail" depends="initMacros">
        <mkdir dir="${mail.target.dir}" />

        <copyStandardFiles toDir="${mail.target.dir}" />

        <copy todir="${mail.target.src.dir}">
             <fileset dir="${src.dir}">
                 <include name="**/mailcap"/>
                 <include name="org.spongycastle.mail/**/*.java" />
                 <include name="org.spongycastle.mail/**/*.properties" />
                 <exclude name="**/*Test.java" />
                 <exclude name="**/*Tests.java" />
                 <exclude name="**/test/*.java" />
             </fileset>
        </copy>

        <copy todir="${build.dir}/${mail.target}/classes">
             <fileset dir="${src.dir}">
                 <include name="**/mailcap"/>
             </fileset>
        </copy>

        <compile target="${mail.target}">
            <jarFileSet>
                <include name="**/*.class"/>
                <include name="**/mailcap"/>
                <include name="**/*.properties"/>
            </jarFileSet>
            <manifestElements>
                <attribute name="Manifest-Version" value="1.0" />
                <attribute name="Extension-Name" value="org.spongycastle.bcmail" />
                <attribute name="Specification-Vendor" value="BouncyCastle.org" />
                <attribute name="Specification-Version" value="1.1" />
                <attribute name="Implementation-Vendor-Id" value="org.spongycastle. />
                <attribute name="Implementation-Vendor" value="BouncyCastle.org" />
                <attribute name="Implementation-Version" value="${release.version}.0" />
                <attribute name="Application-Name" value="Bouncy Castle S/MIME API" />
                <attribute name="Trusted-Library" value="true" />
                <attribute name="Permissions" value="all-permissions" />
                <attribute name="Codebase" value="*" />
                <attribute name="Application-Library-Allowable-Codebase" value="*" />
                <attribute name="Caller-Allowable-Codebase" value="*" />
                <attribute name="Automatic-Module-Name" value="org.spongycastle.mail" />
            </manifestElements>
        </compile>

    </target>

    <target name="build-jmail" depends="initMacros">
        <mkdir dir="${jmail.target.dir}" />

        <copyStandardFiles toDir="${jmail.target.dir}" />

        <copy todir="${jmail.target.src.dir}">
             <fileset dir="${basedir}/jmail/src/main/java">
             </fileset>
             <fileset dir="${src.dir}">
                 <include name="**/mailcap"/>
                 <include name="org.spongycastle.mail/**/*.java" />
                 <include name="org.spongycastle.mail/**/*.properties" />
                 <exclude name="**/handlers/*.java" />
                 <exclude name="**/*Test.java" />
                 <exclude name="**/*Tests.java" />
                 <exclude name="**/test/*.java" />
             </fileset>
        </copy>

        <copy todir="${build.dir}/${jmail.target}/classes">
             <fileset dir="${src.dir}">
                 <include name="**/mailcap"/>
             </fileset>
        </copy>

        <replaceregexp match="javax.activation." replace="jakarta.activation." flags="g" byline="true">
            <fileset dir="${jmail.target.src.dir}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>

        <replaceregexp match="javax.mail." replace="jakarta.mail." flags="g" byline="true">
            <fileset dir="${jmail.target.src.dir}">
                <include name="**/*.java"/>
            </fileset>
        </replaceregexp>

        <compile target="${jmail.target}">
            <jarFileSet>
                <include name="**/*.class"/>
                <include name="**/mailcap"/>
                <include name="**/*.properties"/>
            </jarFileSet>
            <manifestElements>
                <attribute name="Manifest-Version" value="1.0" />
                <attribute name="Extension-Name" value="org.spongycastle.bcmail" />
                <attribute name="Specification-Vendor" value="BouncyCastle.org" />
                <attribute name="Specification-Version" value="1.1" />
                <attribute name="Implementation-Vendor-Id" value="org.spongycastle. />
                <attribute name="Implementation-Vendor" value="BouncyCastle.org" />
                <attribute name="Implementation-Version" value="${release.version}.0" />
                <attribute name="Application-Name" value="Bouncy Castle Jakarta S/MIME API" />
                <attribute name="Trusted-Library" value="true" />
                <attribute name="Permissions" value="all-permissions" />
                <attribute name="Codebase" value="*" />
                <attribute name="Application-Library-Allowable-Codebase" value="*" />
                <attribute name="Caller-Allowable-Codebase" value="*" />
                <attribute name="Automatic-Module-Name" value="org.spongycastle.mail" />
            </manifestElements>
        </compile>

    </target>

    <!--
          TLS
    -->
    <target name="build-tls" depends="initMacros">
        <mkdir dir="${tls.target.dir}" />

        <copyStandardFiles toDir="${tls.target.dir}" />

        <copy todir="${tls.target.src.dir}">
             <fileset dir="${src.dir}">
                 <exclude name="**/*Test.java" />
                 <exclude name="**/*Tests.java" />
                 <exclude name="**/test/*.java" />
                 <include name="org.spongycastle.tls/**/*.java" />
                 <include name="org.spongycastle.tls/**/*.properties" />
                 <include name="org.spongycastle.jsse/**/*.java" />
                 <include name="org.spongycastle.jsse/**/*.properties" />
             </fileset>
        </copy>

        <compile target="${tls.target}">
            <jarFileSet>
                <exclude name="**/test/*.class" />
                <include name="**/*.class"/>
                <include name="**/*.properties"/>
            </jarFileSet>
            <manifestElements>
                <attribute name="Manifest-Version" value="1.0" />
                <attribute name="Extension-Name" value="org.spongycastle.bctls" />
                <attribute name="Specification-Vendor" value="BouncyCastle.org" />
                <attribute name="Specification-Version" value="1.1" />
                <attribute name="Implementation-Vendor-Id" value="org.spongycastle. />
                <attribute name="Implementation-Vendor" value="BouncyCastle.org" />
                <attribute name="Implementation-Version" value="${release.version}.0" />
                <attribute name="Application-Name" value="Bouncy Castle TLS API and Provider" />
                <attribute name="Trusted-Library" value="true" />
                <attribute name="Permissions" value="all-permissions" />
                <attribute name="Codebase" value="*" />
                <attribute name="Application-Library-Allowable-Codebase" value="*" />
                <attribute name="Caller-Allowable-Codebase" value="*" />
                <attribute name="Automatic-Module-Name" value="org.spongycastle.tls" />
            </manifestElements>
        </compile>

    </target>

    <!--
          Utility Classes
    -->
    <target name="build-util" depends="initMacros">
        <mkdir dir="${util.target.dir}" />

        <copyStandardFiles toDir="${util.target.dir}" />

        <copy todir="${util.target.src.dir}">
             <fileset dir="${src.dir}">
                 <exclude name="**/*Test.java" />
                 <exclude name="**/*Tests.java" />
                 <exclude name="**/test/*.java" />
                 <include name="org.spongycastle.asn1/bsi/**" />
                 <include name="org.spongycastle.asn1/cmc/**" />
                 <include name="org.spongycastle.asn1/cmp/**" />
                 <include name="org.spongycastle.asn1/cms/**" />
                 <include name="org.spongycastle.asn1/crmf/**" />
                 <include name="org.spongycastle.asn1/dvcs/**" />
                 <include name="org.spongycastle.asn1/eac/**" />
                 <include name="org.spongycastle.asn1/esf/**" />
                 <include name="org.spongycastle.asn1/ess/**" />
                 <include name="org.spongycastle.asn1/est/**" />
                 <include name="org.spongycastle.asn1/icao/**" />
                 <include name="org.spongycastle.asn1/isismtt/**" />
                 <include name="org.spongycastle.asn1/its/**" />
                 <include name="org.spongycastle.asn1/smime/**" />
                 <include name="org.spongycastle.asn1/tsp/**" />
                 <include name="org.spongycastle.oer/**" />
             </fileset>
        </copy>

        <compile target="${util.target}">
            <jarFileSet>
                <exclude name="**/test/*.class" />
                <include name="**/*.class"/>
                <include name="**/*.properties"/>
            </jarFileSet>
            <manifestElements>
                <attribute name="Manifest-Version" value="1.0" />
                <attribute name="Extension-Name" value="org.spongycastle.bcutil" />
                <attribute name="Specification-Vendor" value="BouncyCastle.org" />
                <attribute name="Specification-Version" value="1.1" />
                <attribute name="Implementation-Vendor-Id" value="org.spongycastle. />
                <attribute name="Implementation-Vendor" value="BouncyCastle.org" />
                <attribute name="Implementation-Version" value="${release.version}.0" />
                <attribute name="Application-Name" value="Bouncy Castle Utility APIs" />
                <attribute name="Trusted-Library" value="true" />
                <attribute name="Permissions" value="all-permissions" />
                <attribute name="Codebase" value="*" />
                <attribute name="Application-Library-Allowable-Codebase" value="*" />
                <attribute name="Caller-Allowable-Codebase" value="*" />
                <attribute name="Automatic-Module-Name" value="org.spongycastle.util" />
            </manifestElements>
        </compile>

    </target>

    <target name="build-pkix" depends="initMacros">
        <mkdir dir="${pkix.target.dir}" />

        <copyStandardFiles toDir="${pkix.target.dir}" />

        <copy todir="${pkix.target.src.dir}">
             <fileset dir="${src.dir}">
                 <include name="org.spongycastle.cms/**/*.java" />
                 <include name="org.spongycastle.pkix/**/*.java" />
                 <include name="org.spongycastle.dvcs/**/*.java" />
                 <include name="org.spongycastle.eac/**/*.java" />
                 <include name="org.spongycastle.est/**" />
                 <include name="org.spongycastle.cmc/**" />
                 <include name="org.spongycastle.cert/**/*.java" />
                 <include name="org.spongycastle.its/**/*.java" />
                 <include name="org.spongycastle.mime/**/*.java" />
                 <include name="org.spongycastle.mozilla/**/*.java" />
                 <include name="org.spongycastle.openssl/**/*.java" />
                 <include name="org.spongycastle.operator/**/*.java" />
                 <include name="org.spongycastle.pkcs/**/*.java" />
                 <include name="org.spongycastle.tsp/**/*.java" />
                 <include name="org.spongycastle.voms/**/*.java" />
                 <exclude name="**/*Test.java" />
                 <exclude name="**/*Tests.java" />
                 <exclude name="**/test/*.*" />
                 <exclude name="**/test/**.*" />
             </fileset>
        </copy>

        <compile target="${pkix.target}">
            <jarFileSet>
                <include name="**/*.class"/>
                <include name="**/*.properties"/>
            </jarFileSet>
            <manifestElements>
                <attribute name="Manifest-Version" value="1.0" />
                <attribute name="Extension-Name" value="org.spongycastle.bcpkix" />
                <attribute name="Specification-Vendor" value="BouncyCastle.org" />
                <attribute name="Specification-Version" value="1.1" />
                <attribute name="Implementation-Vendor-Id" value="org.spongycastle. />
                <attribute name="Implementation-Vendor" value="BouncyCastle.org" />
                <attribute name="Implementation-Version" value="${release.version}.0" />
                <attribute name="Application-Name" value="Bouncy Castle PKIX API" />
                <attribute name="Trusted-Library" value="true" />
                <attribute name="Permissions" value="all-permissions" />
                <attribute name="Codebase" value="*" />
                <attribute name="Application-Library-Allowable-Codebase" value="*" />
                <attribute name="Caller-Allowable-Codebase" value="*" />
                <attribute name="Automatic-Module-Name" value="org.spongycastle.pkix" />
            </manifestElements>
        </compile>

    </target>

    <!--
          PG
    -->
    <target name="build-pg" depends="initMacros">
        <mkdir dir="${pg.target.dir}" />

        <filter token="RELEASE_NAME" value="${release.name}" />

        <copyStandardFiles toDir="${pg.target.dir}" />

        <copy todir="${pg.target.src.dir}" filtering="true">
             <fileset dir="${src.dir}" includes="org.spongycastle.bcpg/**/*.java" />
        </copy>

        <copy todir="${pg.target.src.dir}">
             <fileset dir="${src.dir}">
                 <include name="org.spongycastle.bcpg/**/*.java" />
                 <include name="org.spongycastle.openpgp/**/*.java" />
                 <include name="org.spongycastle.gpg/**/*.java" />
                 <include name="org.spongycastle.apache/**/*.java" />
                 <exclude name="**/*Test.java" />
                 <exclude name="**/*Tests.java" />
                 <exclude name="**/test/*.java" />
             </fileset>
        </copy>

        <compile target="${pg.target}">
            <jarFileSet>
                <include name="**/*.class"/>
                <include name="**/*.properties"/>
            </jarFileSet>
            <manifestElements>
                <attribute name="Manifest-Version" value="1.0" />
                <attribute name="Extension-Name" value="org.spongycastle.bcpg" />
                <attribute name="Specification-Vendor" value="BouncyCastle.org" />
                <attribute name="Specification-Version" value="1.1" />
                <attribute name="Implementation-Vendor-Id" value="org.spongycastle. />
                <attribute name="Implementation-Vendor" value="BouncyCastle.org" />
                <attribute name="Implementation-Version" value="${release.version}.0" />
                <attribute name="Application-Name" value="Bouncy Castle OpenPGP API" />
                <attribute name="Trusted-Library" value="true" /> 
                <attribute name="Permissions" value="all-permissions" />
                <attribute name="Codebase" value="*" />
                <attribute name="Application-Library-Allowable-Codebase" value="*" />
                <attribute name="Caller-Allowable-Codebase" value="*" />
                <attribute name="Automatic-Module-Name" value="org.spongycastle.pg" />
            </manifestElements>
        </compile>

    </target>

    <!--
         Tests
    -->
    <target name="build-test" depends="initMacros">
        <property name="test.target" value="bctest-${target.name}" />

        <mkdir dir="${artifacts.jars.dir}" />

        <property name="test.target.dir" value="${artifacts.dir}/${test.target}" />
        <property name="test.target.src.dir" value="${test.target.dir}/src" />

        <mkdir dir="${test.target.dir}" />

        <copyStandardFiles toDir="${test.target.dir}" />

        <copy todir="${test.target.src.dir}">
             <fileset dir="${src.dir}" includes="**/*AllTests.java" />
             <fileset dir="${src.dir}" includes="**/math/**/*Test.java" />
             <fileset dir="${src.dir}" includes="**/crypto/*/*Test.java" />
             <fileset dir="${src.dir}" includes="**/tsp/*UnitTest.java" />
             <fileset dir="${src.dir}" includes="**/utiltest/*Test.java" />
             <fileset dir="${src.dir}" includes="**/util/io/pem/*Test.java" />
             <fileset dir="${src.dir}" includes="**/test/*.java" />
             <fileset dir="${src.dir}" includes="**/test/*/*.java" />
             <fileset dir="${src.dir}" includes="**/*.asc" />
             <fileset dir="${src.dir}" includes="**/*.pem" />
             <fileset dir="${src.dir}" includes="**/*.p7m" />
             <fileset dir="${src.dir}" includes="**/*.eml" />
             <fileset dir="${src.dir}" includes="**/*.sig" />
             <fileset dir="${src.dir}" includes="**/*.data" />
             <fileset dir="${src.dir}" includes="**/*.der" />
             <fileset dir="${src.dir}" includes="**/*.crt" />
             <fileset dir="${src.dir}" includes="**/*.key" />
             <fileset dir="${src.dir}" includes="**/*.cer" />
             <fileset dir="${src.dir}" includes="**/*.oer" />
             <fileset dir="${src.dir}" includes="**/*.kbx" />
             <fileset dir="${src.dir}" includes="**/*.crl" />
             <fileset dir="${src.dir}" includes="**/*.csr" />
             <fileset dir="${src.dir}" includes="**/*.txt" />
             <fileset dir="${src.dir}" includes="**/*.rsp" />
             <fileset dir="${src.dir}" includes="**/*.gpg" />
             <fileset dir="${src.dir}" includes="**/*.pub" />
             <fileset dir="${src.dir}" includes="**/*.sec" />
             <fileset dir="${src.dir}" includes="**/*.cvcert" />
             <fileset dir="${src.dir}" includes="**/*.properties" />
             <fileset dir="${src.dir}" includes="**/*.message" />
        </copy>

        <delete file="${test.target.src.dir}/org.spongycastle.pqc/crypto/lms/AllTests.java" />
        <delete file="${test.target.src.dir}/org.spongycastle.x509/CertPathReviewerMessages_de.properties" />
        <delete file="${test.target.src.dir}/org.spongycastle.x509/CertPathReviewerMessages.properties" />

        <compile-test target="${test.target}">
            <manifestElements>
                <attribute name="Manifest-Version" value="1.0" />
                <attribute name="Extension-Name" value="org.spongycastle.bctest" />
                <attribute name="Specification-Vendor" value="BouncyCastle.org" />
                <attribute name="Specification-Version" value="1.1" />
                <attribute name="Implementation-Vendor-Id" value="org.spongycastle. />
                <attribute name="Implementation-Vendor" value="BouncyCastle.org" />
                <attribute name="Implementation-Version" value="${release.version}.0" />
                <attribute name="Application-Name" value="Bouncy Castle Test Classes" />
                <attribute name="Trusted-Library" value="true" />
                <attribute name="Permissions" value="all-permissions" />
                <attribute name="Codebase" value="*" />
                <attribute name="Application-Library-Allowable-Codebase" value="*" />
                <attribute name="Caller-Allowable-Codebase" value="*" />
            </manifestElements>
        </compile-test>
    </target>

    <target name="test">
        <property name="test.target" value="bctest-${target.name}" />
        <property name="test.target.dir" value="${artifacts.dir}/${test.target}" />
        <property name="test.target.src.dir" value="${test.target.dir}/src" />

        <mkdir dir="${basedir}/${build.dir}/${target.prefix}" />
        <junit fork="yes" dir="${basedir}/${build.dir}/${target.prefix}" failureProperty="test.failed">
            <classpath>
                <path refid="project.classpath" /> 
                <fileset dir="${artifacts.jars.dir}">
                    <include name="**/*.jar" />
                    <exclude name="**/bcprov-jdk*.jar" />
                    <exclude name="**/bcjmail-jdk*.jar" />
                </fileset>
            </classpath>
            <sysproperty key="bc.test.data.home" value="../../core/src/test/data" />

            <formatter type="xml" />
            <batchtest todir="${artifacts.reports.xml.dir}" unless="testcase">
                <fileset dir="${test.target.src.dir}">
                    <include name="**/AllTests.java" />
                </fileset>
            </batchtest>
        </junit>

        <junitreport todir="${artifacts.reports.xml.dir}">
            <fileset dir="${artifacts.reports.xml.dir}">
                <include name="TEST-*.xml" />
            </fileset>
            <report format="frames" todir="${artifacts.reports.html.dir}" />
        </junitreport>
    </target>

    <target name="test-lw">
        <junit fork="yes" dir="${basedir}/${build.dir}/${target.prefix}" failureProperty="test.failed">
            <classpath>
                <fileset dir="${artifacts.jars.dir}">
                    <include name="**/*.jar" />
                    <exclude name="**/bcprov-jdk*.jar" />
                </fileset>
            </classpath>

            <formatter type="xml" />
            <test name="${testcase}" todir="${artifacts.reports.xml.dir}" if="testcase" />
            <batchtest todir="${artifacts.reports.xml.dir}" unless="testcase">
                <fileset dir="${src.dir}">
                    <include name="**/crypto/test/AllTests.java" />
                    <include name="**/asn1/test/AllTests.java" />
                    <include name="**/encoders/test/AllTests.java" />
                    <include name="**/ntru/**/AllTests.java" />
                </fileset>
            </batchtest>
        </junit>

        <junitreport todir="${artifacts.reports.xml.dir}">
            <fileset dir="${artifacts.reports.xml.dir}">
                <include name="TEST-*.xml" />
            </fileset>
            <report format="frames" todir="${artifacts.reports.html.dir}" />
        </junitreport>
    </target>

    <target name="javadoc-libraries" depends="javadoc-util, javadoc-pkix, javadoc-mail, javadoc-pg" />

    <!--
          Provider JavaDoc
    -->
    <target name="javadoc-provider" depends="initMacros">
        <copy todir="${provider.target.src.dir}">
             <fileset dir="${src.dir}">
                 <include name="org.spongycastle.pqc/**/test/*.java" />
                 <include name="org.spongycastle.jce/**/test/*.java" />
                 <include name="org.spongycastle.jce/**/test/*/*.java" />
                 <include name="org.spongycastle.x509/**/test/*.java" />
                 <include name="org.spongycastle.ocsp/**/test/*.java" />
                 <include name="org.spongycastle.crypto/**/test/*.java" />
                 <include name="org.spongycastle.crypto/**/test/cavp/*.java" />
                 <include name="org.spongycastle.asn1/test/*.java" />
                 <include name="org.spongycastle.crypto/**/*.html" />
                 <include name="org.spongycastle.math/**/*.html" />
                 <include name="org.spongycastle.asn1/**/*.html" />
                 <include name="org.spongycastle.pqc/**/*.html" />
                 <include name="org.spongycastle.util/**/*.html" />
             </fileset>
        </copy>

        <compile-doc srcDir="${provider.target.src.dir}" docsDir="${artifacts.docs.dir}/bcprov">
            <docElements>
                <package name="org.spongycastle.asn1.*" />
                <package name="org.spongycastle.crypto.*" />
                <package name="org.spongycastle.jce.*" />
                <package name="org.spongycastle.jcajce.*" />
                <package name="org.spongycastle.math.*" />
                <package name="org.spongycastle.pqc.*" />
                <package name="org.spongycastle.util.*" />
                <group title="ASN.1 Support Packages" packages="org.spongycastle.asn1*" />
                <group title="JCA/JCE Provider" packages="org.spongycastle.jce.provider*,org.spongycastle.jcajce.provider*" />
                <group title="JCA/JCE Utility and Extension Packages" packages="org.spongycastle.jce*,org.spongycastle.jcajce*" />
                <group title="Lightweight Crypto Packages" packages="org.spongycastle.crypto*" />
                <group title="Math and Utility Packages" packages="org.spongycastle.util*:org.spongycastle.math*" />
                <group title="Test Packages" packages="org.spongycastle.crypto.test*,org.spongycastle.util.utiltest,org.spongycastle.asn1.test*,org.spongycastle.util.encoders.test*,org.spongycastle.util.io.test*,org.spongycastle.util.io.pem.test*,org.spongycastle.math.ec.test*,org.spongycastle.crypto.ec.test*,org.spongycastle.crypto.prng.test*,org.spongycastle.crypto.tls.test*,org.spongycastle.crypto.agreement.test*,org.spongycastle.jce.provider.test*" />
                <group title="Post-Quantum Lightweight Crypto Packages" packages="org.spongycastle.pqc.crypto*" />
                <group title="Post-Quantum ASN.1 Packages" packages="org.spongycastle.pqc.asn1*" />
                <group title="Post-Quantum Lightweight Math Packages" packages="org.spongycastle.pqc.math*" />
                <group title="Post-Quantum Provider" packages="org.spongycastle.pqc.jcajce.*" />
                <group title="Post-Quantum Test Packages" packages="org.spongycastle.pqc.crypto.test*,org.spongycastle.pqc.math.ntru.util.test*,org.spongycastle.pqc.math.ntru.polynomial.test*,org.spongycastle.pqc.jcajce.provider.test*,org.spongycastle.pqc.math.ntru.euclid.test*" />
            </docElements>
        </compile-doc>

        <copy todir="${provider.target.docs.dir}">
             <fileset dir="${artifacts.docs.dir}/bcprov" />
        </copy>
    </target>

    <target name="javadoc-jce" depends="initMacros">
        <copy todir="${jce.target.src.dir}">
             <fileset dir="${src.dir}">
                 <include name="org.spongycastle.jce/**/test/*.java" />
                 <include name="org.spongycastle.jce/**/test/*/*.java" />
                 <include name="org.spongycastle.x509/**/test/*.java" />
                 <include name="org.spongycastle.ocsp/**/test/*.java" />
             </fileset>
        </copy>

        <compile-doc srcDir="${jce.target.src.dir}" docsDir="${artifacts.docs.dir}/jce">
            <docElements>
                <package name="org.spongycastle.asn1.*" />
                <package name="org.spongycastle.crypto.*" />
                <package name="org.spongycastle.jce.*" />
                <package name="org.spongycastle.jcajce.*" />
                <package name="org.spongycastle.x509.*" />
                <package name="org.spongycastle.ocsp.*" />
                <package name="org.spongycastle.util.*" />
                <package name="javax.crypto.*" />
                <group title="JCE Package" packages="javax.crypto*" />
                <group title="JCE Utility and Extension Packages" packages="org.spongycastle.jce*,org.spongycastle.jcajce*" />
                <group title="OCSP Support Packages" packages="org.spongycastle.ocsp*" />
                <group title="ASN.1 Support Packages" packages="org.spongycastle.asn1*" />
                <group title="Lightweight Crypto Packages" packages="org.spongycastle.crypto*" />
                <group title="Utility Packages" packages="org.spongycastle.util*:org.spongycastle.math*" />
                <group title="JCE Provider and Test Classes" packages="org.spongycastle.jce.provider*,org.spongycastle.jcajce.provider*" />
            </docElements>
        </compile-doc>

        <copy todir="${jce.target.docs.dir}">
             <fileset dir="${artifacts.docs.dir}/jce" />
        </copy>
    </target>

    <!--
          Mail JavaDoc
    -->
    <target name="javadoc-mail" depends="initMacros">
        <copy todir="${mail.target.src.dir}">
             <fileset dir="${src.dir}">
                 <include name="org.spongycastle.mail/**/test/*.java" />
                 <include name="org.spongycastle.mail/**/*.html" />
             </fileset>
        </copy>

        <compile-doc srcDir="${mail.target.src.dir}" docsDir="${artifacts.docs.dir}/bcmail">
            <docElements>
                <package name="org.spongycastle.mail.*" />
                <group title="S/MIME Packages" packages="org.spongycastle.mail.smime*" />
            </docElements>
        </compile-doc>

        <copy todir="${mail.target.docs.dir}">
             <fileset dir="${artifacts.docs.dir}/bcmail" />
        </copy>
    </target>

    <!--
          TLS JavaDoc
    -->
    <target name="javadoc-tls" depends="initMacros">
        <copy todir="${tls.target.src.dir}">
             <fileset dir="${src.dir}">
                 <include name="org.spongycastle.jsse/**/test/*.java" />
                 <include name="org.spongycastle.jsse/**/*.html" />
                 <include name="org.spongycastle.tls/**/test/*.java" />
                 <include name="org.spongycastle.tls/**/*.html" />
             </fileset>
        </copy>

        <compile-doc srcDir="${tls.target.src.dir}" docsDir="${artifacts.docs.dir}/bctls">
            <docElements>
                <package name="org.spongycastle.tls.*" />
                <package name="org.spongycastle.jsse.*" />
                <group title="TLS/DTLS Packages" packages="org.spongycastle.tls,org.spongycastle.tls.crypto*" />
                <group title="BC JSSE Provider Packages" packages="org.spongycastle.jsse,org.spongycastle.jsse.provider" />
                <group title="TLS/DTLS/JSSE Provider Test and Example Packages" packages="org.spongycastle.jsse.provider.test*,org.spongycastle.tls.test*" />
            </docElements>
        </compile-doc>

        <copy todir="${tls.target.docs.dir}">
             <fileset dir="${artifacts.docs.dir}/bctls" />
        </copy>
    </target>

    <!--
          UTIL JavaDoc
    -->
    <target name="javadoc-util" depends="initMacros">
        <copy todir="${util.target.src.dir}">
             <fileset dir="${src.dir}">
		<include name="org.spongycastle.asn1/bsi/*.java" />
 		<include name="org.spongycastle.asn1/cmp/*.java" />
 		<include name="org.spongycastle.asn1/crmf/*.java" />
 		<include name="org.spongycastle.asn1/eac/*.java" />
 		<include name="org.spongycastle.asn1/ess/*.java" />
 		<include name="org.spongycastle.asn1/icao/*.java" />
    		<include name="org.spongycastle.asn1/its/*.java" />
   		<include name="org.spongycastle.asn1/tsp/*.java" />
		<include name="org.spongycastle.asn1/cmc/*.java" />
		<include name="org.spongycastle.asn1/cms/*.java" />
		<include name="org.spongycastle.asn1/dvcs/*.java" />
		<include name="org.spongycastle.asn1/esf/*.java" />
		<include name="org.spongycastle.asn1/est/*.java" />
		<include name="org.spongycastle.asn1/isismtt/**/*.java" />
		<include name="org.spongycastle.asn1/smime/*.java" />
                <include name="org.spongycastle.asn1/bsi/**/*.html" />
                <include name="org.spongycastle.asn1/cmp/**/*.html" />
                <include name="org.spongycastle.asn1/crmf/**/*.html" />
                <include name="org.spongycastle.asn1/eac/**/*.html" />
                <include name="org.spongycastle.asn1/ess/**/*.html" />
                <include name="org.spongycastle.asn1/icao/**/*.html" />
                <include name="org.spongycastle.asn1/its/**/*.html" />
                <include name="org.spongycastle.asn1/tsp/**/*.html" />
                <include name="org.spongycastle.asn1/cmc/**/*.html" />
                <include name="org.spongycastle.asn1/cms/**/*.html" />
                <include name="org.spongycastle.asn1/dvcs/**/*.html" />
                <include name="org.spongycastle.asn1/esf/**/*.html" />
                <include name="org.spongycastle.asn1/est/**/*.html" />
                <include name="org.spongycastle.asn1/isismtt/**/*.html" />
                <include name="org.spongycastle.asn1/smime/**/*.html" />
             </fileset>
        </copy>

        <compile-doc srcDir="${util.target.src.dir}" docsDir="${artifacts.docs.dir}/bcutil">
            <docElements>
                <package name="org.spongycastle.asn1.*" />
                <package name="org.spongycastle.oer" />
                <package name="org.spongycastle.oer.*" />
                <group title="Extra ASN.1 Packages" packages="org.spongycastle.asn1*" />
                <group title="Extra ASN.1 Packages (OER)" packages="org.spongycastle.oer*" />
            </docElements>
        </compile-doc>

        <copy todir="${util.target.docs.dir}">
             <fileset dir="${artifacts.docs.dir}/bcutil" />
        </copy>
    </target>

    <!--
          PKIX JavaDoc
    -->
    <target name="javadoc-pkix" depends="initMacros">
        <copy todir="${pkix.target.src.dir}">
             <fileset dir="${src.dir}">
                 <include name="org.spongycastle.cms/**/test/*.java" />
                 <include name="org.spongycastle.pkix/**/test/*.java" />
                 <include name="org.spongycastle.dvcs/**/test/*.java" />
                 <include name="org.spongycastle.eac/**/test/*.java" />
                 <include name="org.spongycastle.est/**/test/*.java" />
                 <include name="org.spongycastle.cmc/**/test/*.java" />
                 <include name="org.spongycastle.cert/**/test/*.java" />
                 <include name="org.spongycastle.mime/**/test/*.java" />
                 <include name="org.spongycastle.pkcs/**/test/*.java" />
                 <include name="org.spongycastle.openssl/**/test/*.java" />
                 <include name="org.spongycastle.mozilla/**/test/*.java" />
                 <include name="org.spongycastle.operator/**/test/*.java" />
                 <include name="org.spongycastle.mime/**/*.html" />
                 <include name="org.spongycastle.cms/**/*.html" />
                 <include name="org.spongycastle.pkix/**/*.html" />
                 <include name="org.spongycastle.dvcs/**/*.html" />
                 <include name="org.spongycastle.eac/**/*.html" />
                 <include name="org.spongycastle.est/**/*.html" />
                 <include name="org.spongycastle.cmc/**/*.html" />
                 <include name="org.spongycastle.cert/**/*.html" />
                 <include name="org.spongycastle.pkcs/**/*.html" />
                 <include name="org.spongycastle.openssl/**/*.html" />
                 <include name="org.spongycastle.operator/**/*.html" />
                 <include name="org.spongycastle.mozilla/**/*.html" />
                 <include name="org.spongycastle.tsp/**/test/*.java" />
                 <include name="org.spongycastle.tsp/**/*.html" />
             </fileset>
        </copy>

        <compile-doc srcDir="${pkix.target.src.dir}" docsDir="${artifacts.docs.dir}/bcpkix">
            <docElements>
                <package name="org.spongycastle.cms.*" />
                <package name="org.spongycastle.dvcs.*" />
                <package name="org.spongycastle.eac.*" />
                <package name="org.spongycastle.est.*" />
                <package name="org.spongycastle.cert.*" />
                <package name="org.spongycastle.pkcs.*" />
                <package name="org.spongycastle.openssl.*" />
                <package name="org.spongycastle.operator.*" />
                <package name="org.spongycastle.mozilla.*" />
                <package name="org.spongycastle.pkix.*" />
                <package name="org.spongycastle.tsp.*" />
                <group title="Certificate Packages" packages="org.spongycastle.cert*,org.spongycastle.mozilla*" />
                <group title="Cryptographic Operators" packages="org.spongycastle.operator*" />
                <group title="CMS Packages" packages="org.spongycastle.cms*" />
                <group title="EST Packages" packages="org.spongycastle.est*" />
                <group title="DVCS Packages" packages="org.spongycastle.dvcs*" />
                <group title="Extended Access Control Packages" packages="org.spongycastle.eac*" />
                <group title="PKCS Packages" packages="org.spongycastle.pkcs*" />
                <group title="MIME Packages" packages="org.spongycastle.mime*" />
                <group title="OpenSSL and PEM Support Packages" packages="org.spongycastle.openssl*" />
                <group title="TSP Packages" packages="org.spongycastle.tsp*" />
                <group title="Test and Example Packages" packages="org.spongycastle.openssl.test*,org.spongycastle.mozilla.test*,org.spongycastle.pkcs.test*,org.spongycastle.cert.test*,org.spongycastle.cert.path.test*,org.spongycastle.cert.ocsp.test*,org.spongycastle.cert.crmf.test*,org.spongycastle.cert.cmp.test*,org.spongycastle.eac.test*,org.spongycastle.dvcs.test*,org.spongycastle.est.test*,org.spongycastle.cms.test*,org.spongycastle.mime.test*,org.spongycastle.tsp.test*,org.spongycastle.operator.test*" />
            </docElements>
        </compile-doc>

        <copy todir="${pkix.target.docs.dir}">
             <fileset dir="${artifacts.docs.dir}/bcpkix" />
        </copy>
    </target>

    <!--
          PG JavaDoc
    -->
    <target name="javadoc-pg" depends="initMacros">
        <copy todir="${pg.target.src.dir}">
             <fileset dir="${src.dir}">
                 <include name="org.spongycastle.openpgp/**/test/*.java" />
                 <include name="org.spongycastle.gpg/**/test/*.java" />
                 <include name="org.spongycastle.bcpg/**/test/*.java" />
                 <include name="org.spongycastle.apache/**/*.html" />
                 <include name="org.spongycastle.openpgp/**/*.html" />
                 <include name="org.spongycastle.gpg/**/*.html" />
                 <include name="org.spongycastle.bcpg/**/*.html" />
             </fileset>
        </copy>

        <compile-doc srcDir="${pg.target.src.dir}" docsDir="${artifacts.docs.dir}/bcpg">
            <docElements>
                <package name="org.spongycastle.openpgp.*" />
                <package name="org.spongycastle.gpg.*" />
                <package name="org.spongycastle.bcpg.*" />
                <group title="BCPG Support Packages" packages="org.spongycastle.bcpg*" />
                <group title="OpenPGP Packages" packages="org.spongycastle.gpg,org.spongycastle.gpg.keybox,org.spongycastle.openpgp*" />
                <group title="OpenPGP Test and Example Packages" packages="org.spongycastle.gpg.test,org.spongycastle.openpgp.test*,org.spongycastle.openpgp.examples*" />
            </docElements>
        </compile-doc>

        <copy todir="${pg.target.docs.dir}">
             <fileset dir="${artifacts.docs.dir}/bcpg" />
       </copy>
    </target>

    <!--
          Light Weight JavaDoc
    -->
    <target name="javadoc-lw" depends="initMacros">
        <copy todir="${lcrypto.target.src.dir}">
             <fileset dir="${src.dir}">
                 <include name="org.spongycastle.crypto/**/test/*.java" />
                 <include name="org.spongycastle.crypto/**/test/cavp/*.java" />
                 <include name="org.spongycastle.asn1/**/test/*.java" />
                 <include name="org.spongycastle.crypto/**/*.html" />
                 <include name="org.spongycastle.math/**/*.html" />
                 <include name="org.spongycastle.asn1/**/*.html" />
                 <include name="org.spongycastle.pqc/**/*.html" />
                 <include name="org.spongycastle.util/**/*.html" />
             </fileset>
        </copy>

        <compile-doc srcDir="${lcrypto.target.src.dir}" docsDir="${artifacts.docs.dir}/lcrypto">
            <docElements>
                <package name="org.spongycastle.asn1.*" />
                <package name="org.spongycastle.crypto.*" />
                <package name="org.spongycastle.pqc.math.*" />
                <package name="org.spongycastle.pqc.crypto.*" />
                <package name="org.spongycastle.pqc.asn1.*" />
                <package name="org.spongycastle.math.*" />
                <package name="org.spongycastle.util.*" />
                <group title="Lightweight Crypto Packages" packages="org.spongycastle.crypto*" />
                <group title="ASN.1 Support Packages" packages="org.spongycastle.asn1*" />
                <group title="Utility Packages" packages="org.spongycastle.util*:org.spongycastle.math*" />
                <group title="Test Packages" packages="org.spongycastle.crypto.test*,org.spongycastle.util.utiltest,org.spongycastle.asn1.test*,org.spongycastle.util.encoders.test*,org.spongycastle.util.io.test*,org.spongycastle.util.io.pem.test*,org.spongycastle.math.ec.test*,org.spongycastle.crypto.ec.test*,org.spongycastle.crypto.prng.test*,org.spongycastle.crypto.tls.test*,org.spongycastle.crypto.agreement.test*" />
                <group title="Post-Quantum Lightweight Crypto Packages" packages="org.spongycastle.pqc.crypto*" />
                <group title="Post-Quantum Lightweight Math Packages" packages="org.spongycastle.pqc.math*" />
                <group title="Post-Quantum ASN.1 Packages" packages="org.spongycastle.pqc.asn1*" />
                <group title="Post-Quantum Test Packages" packages="org.spongycastle.pqc.crypto.test*,org.spongycastle.pqc.math.ntru.util.test*,org.spongycastle.pqc.math.ntru.polynomial.test*,org.spongycastle.pqc.math.ntru.euclid.test*" />
            </docElements>
        </compile-doc>

        <copy todir="${lcrypto.target.docs.dir}">
             <fileset dir="${artifacts.docs.dir}/lcrypto" />
       </copy>
    </target>

    <!--
        jar up the source directories
    -->
    <target name="zip-src" depends="zip-src-check, zip-src-jce, zip-src-jce-ext, zip-src-provider, zip-src-provider-ext">
        <zip basedir="${mail.target.src.dir}" destfile="${mail.target.src.zip}" />
        <delete dir="${mail.target.src.dir}" />
        <zip basedir="${pkix.target.src.dir}" destfile="${pkix.target.src.zip}" />
        <delete dir="${pkix.target.src.dir}" />
        <zip basedir="${pg.target.src.dir}" destfile="${pg.target.src.zip}" />
        <delete dir="${pg.target.src.dir}" />
    </target>

    <target name="zip-src-jce" if="jce.present">
        <zip basedir="${jce.target.src.dir}" destfile="${jce.target.src.zip}">
            <exclude name="**/NTRU*.java" />
            <exclude name="**/ntru/**/*.java" />
        </zip>
    </target>

    <target name="zip-src-provider" if="provider.present">
        <zip basedir="${provider.target.src.dir}" destfile="${provider.target.src.zip}">
            <exclude name="**/javax/crypto/**/*.java"/>
            <exclude name="**/NTRU*.java" />
            <exclude name="**/ntru/**/*.java" />
        </zip>
    </target>

    <target name="zip-src-jce-ext" if="jce.present">
        <zip basedir="${jce.target.src.dir}" destfile="${jce.target.src.zip}">
        </zip>
        <delete dir="${jce.target.src.dir}" />
    </target>

    <target name="zip-src-provider-ext" if="provider.present">
        <zip basedir="${provider.target.src.dir}" destfile="${provider.target.src.zip}">
                <exclude name="**/javax/crypto/**/*.java"/>
        </zip>
        <delete dir="${provider.target.src.dir}" />
    </target>

    <target name="zip-src-check">
        <available property="jce.present" file="${jce.target.src.dir}" />
        <available property="provider.present" file="${provider.target.src.dir}" />
    </target>
</project>

